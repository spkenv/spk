pkg: libpng/1.6.35

sources:
  # This idiom can work with any of (a) a local clone, (b) a git submodule,
  # or (c) nothing (does a fresh clone).
  - path: ./
  - script:
    - if [ ! -d libpng ] ; then git clone https://github.com/glennrp/libpng.git -b v1.6.35 ; fi

build:
  options:
    - pkg: stdfs # provides the default filesystem structure (bin, lib, etc)
    - var: arch    # rebuild if the arch changes
    - var: os      # rebuild if the os changes
    - var: centos  # rebuild if centos version changes
    - pkg: gcc/6.3
    - pkg: cmake/^3.13
    - pkg: zlib
    # - var: sharedlibs
    #   default: off
    #   choices: [on, off]

  # No need for gcc variants because we're only building the pure C library
  # components.
  #
  # variants:
  #   - { gcc: 6.3 }
  #   - { gcc: 9.3 }

  script:
    - cmake -S libpng -B build 
        -DCMAKE_BUILD_TYPE=Release
        -DCMAKE_INSTALL_PREFIX=${PREFIX}
        -DPNG_TESTS=OFF
        -DPNG_EXECUTABLES=OFF
    - cmake --build build --target install

install:
  requirements:
    - pkg: stdfs
    - pkg: zlib
    # Don't include gcc as install requirements, since we're only building
    # the pure C library components.
    # - pkg: gcc
    #   fromBuildEnv: x.x
